# Phase 0: Project Foundation

Sets up the monorepo, tooling, CI skeleton, and shared infrastructure that all subsequent work depends on.

**Depends on:** Nothing
**Parallel with:** Nothing (must complete before Phase 1A and 1B)
**Tasks:** 45

---

### Step 0.1 — Monorepo Scaffold

| ID       | Task                                                                                              | Test                                                                                             |
| -------- | ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| P0.S1.T1 | Initialize root `package.json` with pnpm workspaces pointing to `client/`, `server/`, `shared/`   | `pnpm install` completes without errors; `pnpm -r list` shows all three packages                 |
| P0.S1.T2 | Create `/shared` package with its own `package.json` and `tsconfig.json`                          | `cd shared && pnpm tsc --noEmit` compiles with zero errors on an empty index.ts                  |
| P0.S1.T3 | Create `/server` package with its own `package.json` and `tsconfig.json`, referencing `/shared`   | `cd server && pnpm tsc --noEmit` compiles; can `import {} from '@monopoly/shared'` without error |
| P0.S1.T4 | Create `/client` package by initializing a Next.js app with TypeScript inside `/client`           | `cd client && pnpm dev` starts the Next.js dev server; home page loads at localhost:3000         |
| P0.S1.T5 | Configure `/client` `tsconfig.json` to reference `/shared` with path aliases                      | A file in `/client` can `import {} from '@monopoly/shared'` and `pnpm tsc --noEmit` passes       |
| P0.S1.T6 | Add root-level scripts (`dev`, `build`, `test`, `lint`, `typecheck`) that run across all packages | `pnpm run typecheck` runs tsc in all three packages; `pnpm run build` produces build artifacts   |

### Step 0.2 — Development Tooling

| ID       | Task                                                                                 | Test                                                                                                       |
| -------- | ------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------- |
| P0.S2.T1 | Install and configure ESLint with a shared config at root, extending to all packages | `pnpm run lint` executes across all packages; a deliberate lint violation (e.g., unused var) is flagged    |
| P0.S2.T2 | Install and configure Prettier with a shared `.prettierrc` at root                   | `pnpm exec prettier --check .` returns 0 on formatted code; returns non-zero on unformatted code           |
| P0.S2.T3 | Install Husky and configure a pre-commit hook running lint-staged                    | On `git commit`, lint-staged runs ESLint + Prettier on staged files; commit blocked if violations exist    |
| P0.S2.T4 | Add `.editorconfig` at root with project conventions (indent, charset, newline)      | EditorConfig-compatible editors respect the settings (verify tab/space behavior in a test file)            |
| P0.S2.T5 | Create `.env.example` files for `/server` and `/client` with documented variables    | Both `.env.example` files exist with placeholder values; a startup validation script warns on missing vars |

### Step 0.3 — Testing Infrastructure

| ID       | Task                                                                                     | Test                                                                                                                       |
| -------- | ---------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |
| P0.S3.T1 | Install Vitest in `/shared` and configure with TypeScript support                        | A sample test file `shared/src/__tests__/sample.test.ts` with `expect(1+1).toBe(2)` passes via `pnpm --filter shared test` |
| P0.S3.T2 | Install Vitest in `/server` and configure with TypeScript support                        | A sample test in `server/src/__tests__/sample.test.ts` passes via `pnpm --filter server test`                              |
| P0.S3.T3 | Install Vitest + React Testing Library in `/client` and configure for Next.js            | A sample component test (render a `<div>Hello</div>`, assert text content) passes via `pnpm --filter client test`          |
| P0.S3.T4 | Install Playwright and create base config with browser targets (Chrome, Firefox, WebKit) | `pnpm exec playwright test --list` lists zero tests but exits cleanly; browsers downloadable                               |
| P0.S3.T5 | Configure Vitest coverage reporting (v8 provider) across all packages                    | `pnpm run test -- --coverage` generates an HTML coverage report in each package                                            |

### Step 0.4 — CI/CD Skeleton

| ID       | Task                                                                 | Test                                                            |
| -------- | -------------------------------------------------------------------- | --------------------------------------------------------------- |
| P0.S4.T1 | Create GitHub Actions workflow file that runs `lint` on push/PR      | Push a branch; GH Actions runs lint step and shows pass/fail    |
| P0.S4.T2 | Add `typecheck` step to the CI workflow                              | CI runs `pnpm run typecheck` and fails the build on type errors |
| P0.S4.T3 | Add `test` step to the CI workflow (runs Vitest across all packages) | CI runs all unit tests; a failing test fails the build          |
| P0.S4.T4 | Add `build` step to the CI workflow                                  | CI runs `pnpm run build`; Next.js and server builds succeed     |

### Step 0.5 — Shared Types & Constants

| ID        | Task                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Test                                                                                                                                     |
| --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| P0.S5.T1  | Define `SpaceType` enum and `Space` interface (id, name, type, position, colorGroup?, cost?, etc.)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | TypeScript compiles; a test asserts that the enum has all expected space types (property, railroad, utility, tax, chance, chest, corner) |
| P0.S5.T2  | Define `Player` interface (id, name, token, cash, position, properties, jailStatus, isActive, etc.)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TypeScript compiles; a test creates a valid player object matching the interface                                                         |
| P0.S5.T3  | Define `Property` interface (spaceId, name, type, colorGroup, cost, rentTiers, mortgaged, ownerId, houses)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | TypeScript compiles; a test validates that rentTiers is an array of the correct length                                                   |
| P0.S5.T4  | Define `Card` interface (id, deck, text, effect) and `CardEffect` discriminated union (cash, move, moveBack, jail, collectFromAll, payEachPlayer, repairs, advanceNearestRailroad, advanceNearestUtility, goojf)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TypeScript compiles; a test creates one card of each effect type without type errors (10 variants total)                                 |
| P0.S5.T5  | Define `GameState` interface (gameId, status, players, currentPlayerIndex, board, decks, turnState, settings, events)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TypeScript compiles; a test creates a minimal valid GameState object                                                                     |
| P0.S5.T6  | Define `GameSettings` interface (maxPlayers, startingCash, turnTimeLimit, etc.) with defaults                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | TypeScript compiles; a test validates default settings object has correct starting cash of $1500                                         |
| P0.S5.T7  | Create `board.json` — the 40-space board layout with all property data, rent tiers, costs                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | JSON parses without error; a test validates exactly 40 spaces, 22 streets, 4 railroads, 2 utilities                                      |
| P0.S5.T7a | Validate `board.json` — all 40 spaces present by exact name and position: Pos 0 Go, 1 Mediterranean Ave, 2 Community Chest, 3 Baltic Ave, 4 Income Tax, 5 Reading Railroad, 6 Oriental Ave, 7 Chance, 8 Vermont Ave, 9 Connecticut Ave, 10 Jail/Just Visiting, 11 St. Charles Place, 12 Electric Company, 13 States Ave, 14 Virginia Ave, 15 Pennsylvania Railroad, 16 St. James Place, 17 Community Chest, 18 Tennessee Ave, 19 New York Ave, 20 Free Parking, 21 Kentucky Ave, 22 Chance, 23 Indiana Ave, 24 Illinois Ave, 25 B&O Railroad, 26 Atlantic Ave, 27 Ventnor Ave, 28 Water Works, 29 Marvin Gardens, 30 Go To Jail, 31 Pacific Ave, 32 North Carolina Ave, 33 Community Chest, 34 Pennsylvania Ave, 35 Short Line Railroad, 36 Chance, 37 Park Place, 38 Luxury Tax, 39 Boardwalk | Test: iterate all 40 positions; each matches expected name and type                                                                      |
| P0.S5.T7b | Validate `board.json` — all 8 color groups have correct properties and house costs: Brown (Mediterranean, Baltic; $50/house), Light Blue (Oriental, Vermont, Connecticut; $50/house), Pink (St. Charles, States, Virginia; $100/house), Orange (St. James, Tennessee, New York; $100/house), Red (Kentucky, Indiana, Illinois; $150/house), Yellow (Atlantic, Ventnor, Marvin Gardens; $150/house), Green (Pacific, N. Carolina, Pennsylvania; $200/house), Dark Blue (Park Place, Boardwalk; $200/house)                                                                                                                                                                                                                                                                                      | Test: for each color group, verify member count (brown/dark blue = 2, rest = 3) and house cost                                           |
| P0.S5.T7c | Validate `board.json` — all 22 street properties have correct rent tiers (base, 1 house, 2 houses, 3 houses, 4 houses, hotel) matching official Monopoly rent tables. Example spot checks: Mediterranean base $2/hotel $250, Boardwalk base $50/hotel $2000, Illinois Ave base $20/hotel $1100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Test: assert every street property has exactly 6 rent tiers; spot-check at least one property per color group                            |
| P0.S5.T7d | Validate `board.json` — mortgage values for all 28 properties: streets = half purchase price, railroads = $100 each, utilities = $75 each                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Test: assert mortgage value = price/2 for all streets; railroads mortgage = $100; utilities mortgage = $75                               |
| P0.S5.T7e | Validate `board.json` — Chance spaces at exactly positions 7, 22, 36; Community Chest spaces at exactly positions 2, 17, 33                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Test: filter spaces by type 'chance' → positions [7, 22, 36]; filter by 'communityChest' → positions [2, 17, 33]                         |
| P0.S5.T7f | Validate `board.json` — Tax spaces: Income Tax at position 4 ($200), Luxury Tax at position 38 ($100)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Test: position 4 is type 'tax' with amount $200; position 38 is type 'tax' with amount $100                                              |
| P0.S5.T7g | Validate `board.json` — Railroad prices: all 4 railroads cost $200 (Reading pos 5, Pennsylvania pos 15, B&O pos 25, Short Line pos 35)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Test: all railroad-type spaces have cost $200                                                                                            |
| P0.S5.T7h | Validate `board.json` — Utility prices: Electric Company (pos 12) and Water Works (pos 28) both cost $150                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Test: all utility-type spaces have cost $150                                                                                             |
| P0.S5.T8  | Create `chance-cards.json` — all 16 Chance card definitions with effect descriptors including: Advance to Boardwalk, Advance to Go ($200), Advance to Illinois Ave, Advance to St. Charles Place, Advance to nearest Railroad (×2 — TWO copies of this card), Advance to nearest Utility, Bank pays dividend $50, Get Out of Jail Free, Go Back 3 Spaces, Go to Jail, General repairs ($25/house $100/hotel), Speeding fine $15, Take a trip to Reading Railroad, Elected Chairman pay each player $50, Building loan matures $150                                                                                                                                                                                                                                                             | JSON parses; test validates exactly 16 cards; test validates 2 cards have 'advanceNearestRailroad' effect                                |
| P0.S5.T9  | Create `community-chest-cards.json` — all 16 Community Chest card definitions including: Advance to Go, Bank error $200, Doctor's fee $50, Sale of stock $50, Get Out of Jail Free, Go to Jail, Holiday fund $100, Income tax refund $20, Birthday collect $10 from each player, Life insurance $100, Hospital fees $100, School fees $50, Consultancy fee $25, Street repairs ($40/house $115/hotel), Beauty contest $10, Inherit $100                                                                                                                                                                                                                                                                                                                                                        | JSON parses; test validates exactly 16 cards; each with a valid `CardEffect` shape                                                       |
| P0.S5.T10 | Define `GameAction` discriminated union (RollDice, BuyProperty, DeclineProperty, AuctionBid, AuctionPass, BuildHouse, BuildHotel, SellBuilding, MortgageProperty, UnmortgageProperty, ProposeTrade, AcceptTrade, RejectTrade, CounterTrade, PayJailFine, UseJailCard, RollForDoubles, EndTurn)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | TypeScript compiles; a test creates one action of each type without type errors (18 action types total)                                  |
| P0.S5.T11 | Define Socket.IO event type contracts: `ClientToServerEvents` and `ServerToClientEvents` interfaces                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TypeScript compiles; both interfaces have all expected event names with typed payloads                                                   |
| P0.S5.T12 | Define `GameEvent` interface (id, gameId, type, payload, timestamp) and event type enum                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | TypeScript compiles; a test creates sample events of different types                                                                     |
| P0.S5.T13 | Define `TokenType` enum with classic Monopoly tokens: ScottieDog, TopHat, RaceCar, Boot, Thimble, Iron, Wheelbarrow, Battleship                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | TypeScript compiles; test asserts exactly 8 token types: scottieDog, topHat, raceCar, boot, thimble, iron, wheelbarrow, battleship       |
| P0.S5.T14 | Define `TurnState` enum (WaitingForRoll, Rolling, Resolving, AwaitingBuyDecision, Auction, PlayerAction, TradeNegotiation, EndTurn)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TypeScript compiles; test asserts all expected states are present                                                                        |
| P0.S5.T15 | Define `TradeOffer` interface (id, proposerId, recipientId, offeredProperties, offeredCash, offeredCards, requestedProperties, requestedCash, requestedCards, status)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | TypeScript compiles; test creates a valid trade offer object                                                                             |
| P0.S5.T16 | Define `MoneyDenomination` type and starting cash breakdown constant: 2×$500, 4×$100, 1×$50, 1×$20, 2×$10, 1×$5, 5×$1 = $1,500 total. Denominations available in the game: $1, $5, $10, $20, $50, $100, $500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Test: sum of starting cash breakdown equals $1500; all 7 denominations defined                                                           |
| P0.S5.T17 | Define `TitleDeedData` interface (propertyId, name, colorGroup, cost, rentTiers, mortgageValue, houseCost, hotelCost) — represents the physical title deed card data for all 28 properties (22 streets + 4 railroads + 2 utilities)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | TypeScript compiles; test validates 28 title deed entries exist                                                                          |
